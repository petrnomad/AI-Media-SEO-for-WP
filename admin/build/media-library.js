/*! For license information please see media-library.js.LICENSE.txt */
(()=>{"use strict";var t={20:(t,e,n)=>{var r=n(609),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function s(t,e,n){var r,a={},s=null,u=null;for(r in void 0!==n&&(s=""+n),void 0!==e.key&&(s=""+e.key),void 0!==e.ref&&(u=e.ref),e)i.call(e,r)&&!c.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===a[r]&&(a[r]=e[r]);return{$$typeof:o,type:t,key:s,ref:u,props:a,_owner:l.current}}e.Fragment=a,e.jsx=s,e.jsxs=s},609:t=>{t.exports=window.React},848:(t,e,n)=>{t.exports=n(20)}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);const r=window.wp.element,o=window.wp.components,a=window.wp.apiFetch;var i=n.n(a);function l(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var l=r&&r.prototype instanceof s?r:s,u=Object.create(l.prototype);return c(u,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),u}var i={};function s(){}function u(){}function d(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(c(e={},r,function(){return this}),e),p=d.prototype=s.prototype=Object.create(f);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t}return u.prototype=d,c(p,"constructor",d),c(d,"constructor",u),u.displayName="GeneratorFunction",c(d,o,"GeneratorFunction"),c(p),c(p,o,"Generator"),c(p,r,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(l=function(){return{w:a,m:h}})()}function c(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}c=function(t,e,n,r){function a(e,n){c(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},c(t,e,n,r)}function s(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}var u=function(t){if(!t)return"";var e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""};function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach(function(e){h(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function h(t,e,n){return(e=function(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return m(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(m(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,m(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,m(d,"constructor",s),m(s,"constructor",c),c.displayName="GeneratorFunction",m(s,o,"GeneratorFunction"),m(d),m(d,o,"Generator"),m(d,r,function(){return this}),m(d,"toString",function(){return"[object Generator]"}),(y=function(){return{w:a,m:f}})()}function m(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}m=function(t,e,n,r){function a(e,n){m(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},m(t,e,n,r)}function v(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function g(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){v(a,r,o,i,l,"next",t)}function l(t){v(a,r,o,i,l,"throw",t)}i(void 0)})}}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return x(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function S(t,e,n){return(e=function(t){var e=function(t){if("object"!=j(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==j(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w="pending",O="processing",A="processed",C="approved",P="failed",_=[{label:"All",value:"all"},{label:"Pending",value:w},{label:"Processing",value:O},{label:"Processed",value:A},{label:"Approved",value:C},{label:"Failed",value:P}],k=[{label:"All Images",value:"all"},{label:"Attached to Posts",value:"attached"},{label:"Not Attached",value:"unattached"}],T=(S(S(S(S(S({},w,"ai-media-status-pending"),O,"ai-media-status-processing"),A,"ai-media-status-processed"),C,"ai-media-status-approved"),P,"ai-media-status-failed"),function(){var t=["Analyzing image...","Processing with AI...","Generating metadata...","Optimizing for SEO...","Almost there..."];return t[Math.floor(Math.random()*t.length)]});function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function D(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return N(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function F(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return z(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(z(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,z(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,z(d,"constructor",s),z(s,"constructor",c),c.displayName="GeneratorFunction",z(s,o,"GeneratorFunction"),z(d),z(d,o,"Generator"),z(d,r,function(){return this}),z(d,"toString",function(){return"[object Generator]"}),(F=function(){return{w:a,m:f}})()}function z(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}z=function(t,e,n,r){function a(e,n){z(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},z(t,e,n,r)}function M(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=G(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function B(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function L(t){return function(t){if(Array.isArray(t))return U(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||G(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(t,e){if(t){if("string"==typeof t)return U(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(t,e):void 0}}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var R=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=(t=(0,r.useState)([]),e=2,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||G(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],l=o[1],c=function(){l([])},s=function(){var t,e=(t=F().m(function t(){var e,r,o,l,s;return F().w(function(t){for(;;)switch(t.p=t.n){case 0:if(0!==a.length){t.n=1;break}return alert("Please select images to delete."),t.a(2);case 1:if(confirm("Delete ".concat(a.length," selected images? This cannot be undone."))){t.n=2;break}return t.a(2);case 2:t.p=2,e=M(a),t.p=3,e.s();case 4:if((r=e.n()).done){t.n=6;break}return o=r.value,t.n=5,i()({path:"/wp/v2/media/".concat(o),method:"DELETE",data:{force:!0}});case 5:t.n=4;break;case 6:t.n=8;break;case 7:t.p=7,l=t.v,e.e(l);case 8:return t.p=8,e.f(),t.f(8);case 9:if(c(),!n){t.n=10;break}return t.n=10,n();case 10:t.n=12;break;case 11:t.p=11,s=t.v,alert("Error deleting images: "+s.message);case 12:return t.a(2)}},t,null,[[3,7,8,9],[2,11]])}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){B(a,r,o,i,l,"next",t)}function l(t){B(a,r,o,i,l,"throw",t)}i(void 0)})});return function(){return e.apply(this,arguments)}}();return{selectedIds:a,toggleSelection:function(t){l(function(e){return e.includes(t)?e.filter(function(e){return e!==t}):[].concat(L(e),[t])})},selectAll:function(t){var e=t.map(function(t){return t.id}),n=e.every(function(t){return a.includes(t)});l(n?function(t){return t.filter(function(t){return!e.includes(t)})}:function(t){var n=e.filter(function(e){return!t.includes(e)});return[].concat(L(t),L(n))})},clearSelection:c,isSelected:function(t){return a.includes(t)},handleBulkDelete:s}};function K(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return W(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(W(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,W(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,W(d,"constructor",s),W(s,"constructor",c),c.displayName="GeneratorFunction",W(s,o,"GeneratorFunction"),W(d),W(d,o,"Generator"),W(d,r,function(){return this}),W(d,"toString",function(){return"[object Generator]"}),(K=function(){return{w:a,m:f}})()}function W(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}W=function(t,e,n,r){function a(e,n){W(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},W(t,e,n,r)}function q(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=H(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function $(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function V(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||H(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,e){if(t){if("string"==typeof t)return Q(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(t,e):void 0}}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=V((0,r.useState)({}),2),o=n[0],a=n[1],l=V((0,r.useState)([]),2),c=l[0],s=l[1],u=(0,r.useRef)(null),d=(0,r.useRef)(new Set);return(0,r.useEffect)(function(){var n=function(){var n,r=(n=K().m(function n(){var r,o,l,c,s,f,p,h,y,m;return K().w(function(n){for(;;)switch(n.p=n.n){case 0:if(r=t.filter(function(t){var e,n=(null===(e=t.meta)||void 0===e?void 0:e._ai_media_status)||"pending";return"pending"===n||"processing"===n}),0!==r.length){n.n=1;break}return u.current&&(clearInterval(u.current),u.current=null),n.a(2);case 1:return n.p=1,o=r.map(function(t){return t.id}).join(","),n.n=2,i()({path:"/ai-media/v1/queue-status?attachment_ids=".concat(o),method:"GET"});case 2:l=n.v,a(l),c=[],s=q(r);try{for(s.s();!(f=s.n()).done;)h=f.value,y=null===(p=h.meta)||void 0===p?void 0:p._ai_media_status,m=l[h.id],"processing"!==y&&"pending"!==y||null!=m&&m.in_queue||d.current.has(h.id)||(d.current.add(h.id),e&&c.push(e(h.id)))}catch(t){s.e(t)}finally{s.f()}if(!(c.length>0)){n.n=3;break}return n.n=3,Promise.all(c);case 3:n.n=5;break;case 4:n.p=4,n.v;case 5:return n.a(2)}},n,null,[[1,4]])}),function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function i(t){$(a,r,o,i,l,"next",t)}function l(t){$(a,r,o,i,l,"throw",t)}i(void 0)})});return function(){return r.apply(this,arguments)}}();return t.filter(function(t){var e,n=(null===(e=t.meta)||void 0===e?void 0:e._ai_media_status)||"pending";return"pending"===n||"processing"===n}).length>0?(n(),u.current||(u.current=setInterval(n,3e3))):(u.current&&(clearInterval(u.current),u.current=null),d.current.clear()),function(){u.current&&(clearInterval(u.current),u.current=null)}},[t,e]),{queueStatus:o,processingIds:c,addProcessingId:function(t){s(function(e){return[].concat(function(t){if(Array.isArray(t))return Q(t)}(n=e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||H(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t]);var n})},removeProcessingId:function(t){s(function(e){return e.filter(function(e){return e!==t})})}}};function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function J(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return Z(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(Z(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Z(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,Z(d,"constructor",s),Z(s,"constructor",c),c.displayName="GeneratorFunction",Z(s,o,"GeneratorFunction"),Z(d),Z(d,o,"Generator"),Z(d,r,function(){return this}),Z(d,"toString",function(){return"[object Generator]"}),(J=function(){return{w:a,m:f}})()}function Z(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Z=function(t,e,n,r){function a(e,n){Z(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},Z(t,e,n,r)}function tt(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function et(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){tt(a,r,o,i,l,"next",t)}function l(t){tt(a,r,o,i,l,"throw",t)}i(void 0)})}}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach(function(e){ot(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ot(t,e,n){return(e=function(t){var e=function(t){if("object"!=X(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function at(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return it(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?it(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var lt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.refreshAttachment,o=void 0===n?null:n,a=e.isAttachmentProcessing,l=void 0===a?null:a,c=at((0,r.useState)(null),2),s=c[0],d=c[1],f=at((0,r.useState)(!1),2),p=f[0],h=f[1],y=function(t,e){d({id:t,value:e,isDraft:arguments.length>2&&void 0!==arguments[2]&&arguments[2]})},m=function(){d(null)},v=function(){var t=et(J().m(function t(e){return J().w(function(t){for(;;)switch(t.p=t.n){case 0:if(s&&!p){t.n=1;break}return t.a(2);case 1:return h(!0),t.p=2,t.n=3,e(s);case 3:d(null),t.n=5;break;case 4:throw t.p=4,t.v;case 5:return t.p=5,h(!1),t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}));return function(e){return t.apply(this,arguments)}}(),g=function(){var e=et(J().m(function e(){return J().w(function(e){for(;;)switch(e.n){case 0:if(t&&o){e.n=1;break}return e.a(2);case 1:return e.n=2,v(function(){var e=et(J().m(function e(n){var r;return J().w(function(e){for(;;)switch(e.n){case 0:r=t,e.n="alt"===r?1:"caption"===r?4:"title"===r?6:"status"===r?9:11;break;case 1:return e.n=2,i()({path:"/wp/v2/media/".concat(n.id),method:"POST",data:{alt_text:n.value}});case 2:if(!n.isDraft){e.n=3;break}return e.n=3,i()({path:"/wp/v2/media/".concat(n.id),method:"POST",data:{meta:{_ai_media_draft_alt:""}}});case 3:case 5:case 8:case 10:case 11:return e.a(3,12);case 4:return e.n=5,i()({path:"/wp/v2/media/".concat(n.id),method:"POST",data:{caption:n.value}});case 6:return e.n=7,i()({path:"/wp/v2/media/".concat(n.id),method:"POST",data:{title:n.value}});case 7:if(!n.isDraft){e.n=8;break}return e.n=8,i()({path:"/wp/v2/media/".concat(n.id),method:"POST",data:{meta:{_ai_media_draft_title:""}}});case 9:return e.n=10,i()({path:"/wp/v2/media/".concat(n.id),method:"POST",data:{meta:{_ai_media_status:n.value}}});case 12:return e.n=13,o(n.id);case 13:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return rt({editing:s,saving:p,startEditing:y,updateValue:function(t){d(function(e){return rt(rt({},e),{},{value:t})})},cancelEditing:m,save:v,setSaving:h},t&&{handleClick:function(e){if(t&&(!l||!l(e)))switch(t){case"alt":var n,r=(null===(n=e.meta)||void 0===n?void 0:n._ai_media_draft_alt)&&!e.alt_text,o=r?e.meta._ai_media_draft_alt:e.alt_text||"";y(e.id,o,r);break;case"caption":var a,i="";"string"==typeof e.caption?i=u(e.caption):null!==(a=e.caption)&&void 0!==a&&a.rendered&&(i=u(e.caption.rendered)),y(e.id,i,!1);break;case"title":var c,s,d,f=(null===(c=e.meta)||void 0===c?void 0:c._ai_media_draft_title)&&!(null!==(s=e.title)&&void 0!==s&&s.rendered),p="";f?p=e.meta._ai_media_draft_title:"string"==typeof e.title?p=u(e.title):null!==(d=e.title)&&void 0!==d&&d.rendered&&(p=u(e.title.rendered)),y(e.id,p,f);break;case"status":var h,m=(null===(h=e.meta)||void 0===h?void 0:h._ai_media_status)||"pending";y(e.id,m,!1)}},handleKeyDown:function(e){t&&("Escape"===e.key?m():"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g()))},handleSave:g})};function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function st(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return ut(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(ut(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,ut(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,ut(d,"constructor",s),ut(s,"constructor",c),c.displayName="GeneratorFunction",ut(s,o,"GeneratorFunction"),ut(d),ut(d,o,"Generator"),ut(d,r,function(){return this}),ut(d,"toString",function(){return"[object Generator]"}),(st=function(){return{w:a,m:f}})()}function ut(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ut=function(t,e,n,r){function a(e,n){ut(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},ut(t,e,n,r)}function dt(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function ft(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){dt(a,r,o,i,l,"next",t)}function l(t){dt(a,r,o,i,l,"throw",t)}i(void 0)})}}function pt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ht(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ht(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function vt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(mt(t)+" is not iterable")}function gt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return bt(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(bt(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,bt(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,bt(d,"constructor",s),bt(s,"constructor",c),c.displayName="GeneratorFunction",bt(s,o,"GeneratorFunction"),bt(d),bt(d,o,"Generator"),bt(d,r,function(){return this}),bt(d,"toString",function(){return"[object Generator]"}),(gt=function(){return{w:a,m:f}})()}function bt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}bt=function(t,e,n,r){function a(e,n){bt(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},bt(t,e,n,r)}function xt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Pt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function jt(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function wt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach(function(e){Ot(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ot(t,e,n){return(e=function(t){var e=function(t){if("object"!=mt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function At(t){return function(t){if(Array.isArray(t))return _t(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Pt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||Pt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(t,e){if(t){if("string"==typeof t)return _t(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_t(t,e):void 0}}function _t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Tt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(kt(t)+" is not iterable")}function It(t){return function(t){if(Array.isArray(t))return Ut(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Gt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return Dt(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(Dt(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Dt(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,Dt(d,"constructor",s),Dt(s,"constructor",c),c.displayName="GeneratorFunction",Dt(s,o,"GeneratorFunction"),Dt(d),Dt(d,o,"Generator"),Dt(d,r,function(){return this}),Dt(d,"toString",function(){return"[object Generator]"}),(Et=function(){return{w:a,m:f}})()}function Dt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Dt=function(t,e,n,r){function a(e,n){Dt(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},Dt(t,e,n,r)}function Nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(n),!0).forEach(function(e){zt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function zt(t,e,n){return(e=function(t){var e=function(t){if("object"!=kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mt(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function Bt(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Mt(a,r,o,i,l,"next",t)}function l(t){Mt(a,r,o,i,l,"throw",t)}i(void 0)})}}function Lt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||Gt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(t,e){if(t){if("string"==typeof t)return Ut(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ut(t,e):void 0}}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Kt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return Wt(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(Wt(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Wt(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,Wt(d,"constructor",s),Wt(s,"constructor",c),c.displayName="GeneratorFunction",Wt(s,o,"GeneratorFunction"),Wt(d),Wt(d,o,"Generator"),Wt(d,r,function(){return this}),Wt(d,"toString",function(){return"[object Generator]"}),(Kt=function(){return{w:a,m:f}})()}function Wt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Wt=function(t,e,n,r){function a(e,n){Wt(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},Wt(t,e,n,r)}function qt(t){return function(t){if(Array.isArray(t))return Zt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Jt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$t(Object(n),!0).forEach(function(e){Ht(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ht(t,e,n){return(e=function(t){var e=function(t){if("object"!=Rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qt(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function Yt(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Qt(a,r,o,i,l,"next",t)}function l(t){Qt(a,r,o,i,l,"throw",t)}i(void 0)})}}function Xt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||Jt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(t,e){if(t){if("string"==typeof t)return Zt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zt(t,e):void 0}}function Zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function te(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ne=function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(null===(e=t.meta)||void 0===e?void 0:e._ai_media_status)||w,a=(null===(n=r[t.id])||void 0===n?void 0:n.in_queue)||!1;return o===O||o===w&&a},re=n(848);const oe=function(t){var e=t.notice,n=t.onDismiss;return e?(0,re.jsxs)("div",{className:"notice notice-".concat(e.type," is-dismissible"),style:{margin:"0 0 20px 0"},children:[(0,re.jsx)("p",{children:e.message}),(0,re.jsx)("button",{type:"button",className:"notice-dismiss",onClick:n,children:(0,re.jsx)("span",{className:"screen-reader-text",children:"Dismiss this notice."})})]}):null},ae=function(t){var e=t.hoveredImage;return e?(0,re.jsx)("div",{className:"ai-media-thumbnail-hover",style:{left:"".concat(e.x,"px"),top:"".concat(e.y,"px")},children:(0,re.jsx)("img",{src:e.imageUrl,alt:"Preview"})}):null},ie=function(t){var e=t.batchProgress,n=t.processingStatus,r=t.onCancel,o=t.onClose,a=t.cancelledRef;return null!=e&&e.active?(0,re.jsx)("div",{className:"batch-processing-overlay",children:(0,re.jsxs)("div",{className:"batch-processing-modal",children:[(0,re.jsx)("h2",{children:"AI Processing in Progress"}),(0,re.jsxs)("p",{className:"batch-processing-description",children:["Processing images with AI. This may take several minutes. ",(0,re.jsx)("strong",{children:"Please do not close this window"})," until processing is complete."]}),n&&(0,re.jsx)("div",{className:"processing-status-message",children:n}),(0,re.jsx)("div",{className:"progress-bar-container",children:(0,re.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(e.current/e.total*100,"%")}})}),(0,re.jsxs)("div",{className:"progress-stats",children:[(0,re.jsxs)("div",{className:"progress-percentage",children:[Math.round(e.current/e.total*100),"%"]}),(0,re.jsxs)("div",{className:"progress-text",children:[e.current," / ",e.total," images"]})]}),(0,re.jsxs)("div",{className:"batch-results",children:[(0,re.jsxs)("div",{className:"batch-result-item",children:[(0,re.jsx)("div",{className:"result-label",children:"Successful"}),(0,re.jsx)("div",{className:"success-count",children:e.success.length})]}),(0,re.jsxs)("div",{className:"batch-result-item",children:[(0,re.jsx)("div",{className:"result-label",children:"Failed"}),(0,re.jsx)("div",{className:"failed-count",children:e.failed.length})]})]}),(0,re.jsx)("div",{className:"modal-actions",children:(0,re.jsx)("button",{type:"button",onClick:function(){e.current===e.total?o():(a&&(a.current=!0),r())},children:e.current===e.total?"Close":"Cancel Processing"})})]})}):null},le=function(t){var e=t.isOpen,n=t.onClose,r=t.searchQuery,a=t.onSearchChange,i=t.onSearch,l=t.isSearching,c=t.searchResults,s=t.selectedId,u=t.onSelectId,d=t.onSubmit;return e?(0,re.jsxs)(o.Modal,{title:"Attach to existing content",onRequestClose:n,className:"ai-media-attach-modal",style:{maxWidth:"720px"},children:[(0,re.jsxs)("div",{className:"find-box-search",style:{padding:"20px 20px 0",borderBottom:"1px solid #dcdcde",marginBottom:"16px"},children:[(0,re.jsx)("input",{type:"text",value:r,onChange:function(t){return a(t.target.value)},onKeyDown:function(t){return"Enter"===t.key&&i()},placeholder:"Search",style:{width:"calc(100% - 90px)",padding:"6px 12px",fontSize:"14px",border:"1px solid #8c8f94",borderRadius:"3px",marginRight:"8px"}}),(0,re.jsx)(o.Button,{variant:"secondary",onClick:i,isBusy:l,disabled:l,children:l?"Searching...":"Search"})]}),(0,re.jsx)("div",{className:"find-box-response",style:{maxHeight:"400px",overflowY:"auto",padding:"0 20px"},children:0===c.length?(0,re.jsx)("p",{style:{textAlign:"center",color:"#646970",padding:"40px 20px"},children:l?"Searching...":"No results found. Try a different search term."}):(0,re.jsxs)("table",{className:"widefat",style:{marginBottom:"0"},children:[(0,re.jsx)("thead",{children:(0,re.jsxs)("tr",{children:[(0,re.jsx)("th",{style:{width:"40px"}}),(0,re.jsx)("th",{children:"Title"}),(0,re.jsx)("th",{style:{whiteSpace:"nowrap"},children:"Type"}),(0,re.jsx)("th",{style:{whiteSpace:"nowrap"},children:"Date"}),(0,re.jsx)("th",{style:{whiteSpace:"nowrap"},children:"Status"})]})}),(0,re.jsx)("tbody",{children:c.map(function(t,e){return(0,re.jsxs)("tr",{className:e%2==0?"":"alternate",children:[(0,re.jsx)("td",{style:{textAlign:"center"},children:(0,re.jsx)("input",{type:"radio",name:"found_post_id",value:t.id,checked:s===t.id,onChange:function(){return u(t.id)},id:"found-".concat(t.id)})}),(0,re.jsx)("td",{children:(0,re.jsx)("label",{htmlFor:"found-".concat(t.id),style:{cursor:"pointer"},children:t.title})}),(0,re.jsx)("td",{style:{whiteSpace:"nowrap"},children:t.type}),(0,re.jsx)("td",{style:{whiteSpace:"nowrap"},children:(n=t.date,r=new Date(n),o=r.getDate(),a=r.getMonth()+1,i=r.getFullYear(),"".concat(a,"/").concat(o,"/").concat(i))}),(0,re.jsx)("td",{style:{whiteSpace:"nowrap"},children:t.status})]},t.id);var n,r,o,a,i})})]})}),(0,re.jsxs)("div",{className:"find-box-buttons",style:{padding:"16px 20px",borderTop:"1px solid #dcdcde",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[(0,re.jsx)(o.Button,{variant:"secondary",onClick:n,children:"Close"}),(0,re.jsx)(o.Button,{variant:"primary",onClick:d,disabled:!s,children:"Select"})]})]}):null},ce=function(t){var e=t.isOpen,n=t.onClose,r=t.fileInputRef,a=t.onFileSelect,i=t.isDragging,l=t.onDragEnter,c=t.onDragLeave,s=t.onDragOver,u=t.onDrop,d=t.uploading,f=t.uploadFiles,p=t.onStartUpload,h=t.uploadProgress,y=t.onRemoveFile;return e?(0,re.jsx)(o.Modal,{title:"Drop files to upload",onRequestClose:n,className:"ai-media-upload-modal",children:(0,re.jsxs)("div",{className:"upload-modal-content",children:[(0,re.jsx)("input",{ref:r,type:"file",multiple:!0,accept:"image/*",style:{display:"none"},onChange:a}),(0,re.jsx)("div",{className:"upload-drop-zone ".concat(i?"dragging":""),onDragEnter:l,onDragLeave:c,onDragOver:s,onDrop:u,onClick:function(){var t;return!d&&(null===(t=r.current)||void 0===t?void 0:t.click())},children:(0,re.jsxs)("div",{className:"upload-drop-zone-content",children:[(0,re.jsx)("span",{className:"dashicons dashicons-upload",style:{fontSize:"80px",color:"#c3c4c7",marginBottom:"55px",marginLeft:"-55px"}}),(0,re.jsx)("p",{style:{fontSize:"18px",margin:"0 0 8px 0",color:"#1d2327"},children:i?"Drop files here":"Drop images here"}),(0,re.jsx)("p",{style:{fontSize:"14px",margin:"0 0 16px 0",color:"#646970"},children:"or"}),(0,re.jsx)(o.Button,{variant:"primary",disabled:d,children:"Select Files"}),(0,re.jsx)("p",{style:{fontSize:"13px",margin:"16px 0 0 0",color:"#646970",fontStyle:"italic"},children:"Maximum upload file size: 128 MB"})]})}),f.length>0&&(0,re.jsxs)("div",{className:"upload-modal-actions",style:{display:"flex",justifyContent:"center",gap:"12px",marginTop:"20px",paddingTop:"20px",borderTop:"1px solid #dcdcde"},children:[(0,re.jsx)(o.Button,{variant:"secondary",onClick:n,disabled:d,children:"Close"}),(0,re.jsx)(o.Button,{variant:"primary",onClick:p,disabled:0===f.length||d,isBusy:d,children:d?"Uploading...":"Upload (".concat(f.length,")")})]}),f.length>0&&(0,re.jsxs)("div",{className:"upload-file-list",children:[(0,re.jsx)("h3",{style:{fontSize:"14px",fontWeight:"600",margin:"24px 0 12px 0",color:"#1d2327"},children:"Upload Progress"}),(0,re.jsx)("div",{className:"upload-files",children:f.map(function(t,e){var n=h[t.name]||{status:"pending",progress:0};return(0,re.jsxs)("div",{className:"upload-file-item",children:[(0,re.jsxs)("div",{className:"upload-file-info",children:[(0,re.jsx)("span",{className:"upload-file-name",children:t.name}),(0,re.jsxs)("span",{className:"upload-file-size",children:[(t.size/1024/1024).toFixed(2)," MB"]})]}),(0,re.jsxs)("div",{className:"upload-file-status",children:["pending"===n.status&&(0,re.jsx)("button",{type:"button",className:"upload-file-remove",onClick:function(){return y(t.name)},disabled:d,children:(0,re.jsx)("span",{className:"dashicons dashicons-no-alt"})}),"uploading"===n.status&&(0,re.jsx)(o.Spinner,{}),"completed"===n.status&&(0,re.jsx)("span",{className:"dashicons dashicons-yes-alt",style:{color:"#00a32a",fontSize:"20px"}}),"failed"===n.status&&(0,re.jsx)("span",{className:"dashicons dashicons-warning",style:{color:"#d63638",fontSize:"20px"},title:n.error})]})]},e)})})]})]})}):null};function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const ue=function(t){var e=t.isOpen,n=t.onClose,r=t.costStats,a=t.costBreakdown,i=t.liveTotalCost;return e?(0,re.jsx)(o.Modal,{title:"Cost Statistics",onRequestClose:n,style:{maxWidth:"800px"},children:(0,re.jsx)("div",{style:{padding:"20px"},children:r&&a?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)("div",{style:{background:"#f0f6fc",padding:"20px",borderRadius:"8px",marginBottom:"24px",border:"1px solid #c3e7ff"},children:[(0,re.jsxs)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#1d2327",display:"flex",alignItems:"center",gap:"8px"},children:[(0,re.jsx)("span",{className:"dashicons dashicons-chart-bar",style:{color:"#2271b1"}}),"Overall Statistics"]}),(0,re.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px"},children:[(0,re.jsxs)("div",{children:[(0,re.jsx)("div",{style:{fontSize:"12px",color:"#646970",marginBottom:"4px"},children:"Total Cost"}),(0,re.jsxs)("div",{style:{fontSize:"24px",fontWeight:"600",color:"#2271b1"},children:["$",(void 0!==i?i:r.total_cost).toFixed(4)]})]}),(0,re.jsxs)("div",{children:[(0,re.jsx)("div",{style:{fontSize:"12px",color:"#646970",marginBottom:"4px"},children:"Images Processed"}),(0,re.jsx)("div",{style:{fontSize:"24px",fontWeight:"600",color:"#1d2327"},children:r.total_images_processed.toLocaleString()})]}),(0,re.jsxs)("div",{children:[(0,re.jsx)("div",{style:{fontSize:"12px",color:"#646970",marginBottom:"4px"},children:"Avg Cost/Image"}),(0,re.jsxs)("div",{style:{fontSize:"24px",fontWeight:"600",color:"#1d2327"},children:["$",r.average_cost_per_image.toFixed(6)]})]})]}),(0,re.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginTop:"16px"},children:[(0,re.jsxs)("div",{children:[(0,re.jsx)("div",{style:{fontSize:"12px",color:"#646970",marginBottom:"4px"},children:"Total Tokens Used"}),(0,re.jsx)("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1d2327"},children:r.total_tokens_used.toLocaleString()})]}),(0,re.jsxs)("div",{children:[(0,re.jsx)("div",{style:{fontSize:"12px",color:"#646970",marginBottom:"4px"},children:"Most Expensive Model"}),(0,re.jsx)("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1d2327"},children:r.most_expensive_model||"N/A"})]})]}),r.last_sync&&(0,re.jsxs)("div",{style:{marginTop:"16px",fontSize:"12px",color:"#646970"},children:["Last pricing update: ",r.last_sync]})]}),(0,re.jsxs)("div",{children:[(0,re.jsxs)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#1d2327",display:"flex",alignItems:"center",gap:"8px"},children:[(0,re.jsx)("span",{className:"dashicons dashicons-performance",style:{color:"#2271b1"}}),"Cost Breakdown by Model"]}),(0,re.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #c3c4c7",background:"#fff"},children:[(0,re.jsx)("thead",{children:(0,re.jsxs)("tr",{style:{background:"#f6f7f7",borderBottom:"2px solid #c3c4c7"},children:[(0,re.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"13px",fontWeight:"600"},children:"Model"}),(0,re.jsx)("th",{style:{padding:"12px",textAlign:"right",fontSize:"13px",fontWeight:"600"},children:"Images"}),(0,re.jsx)("th",{style:{padding:"12px",textAlign:"right",fontSize:"13px",fontWeight:"600"},children:"Input Tokens"}),(0,re.jsx)("th",{style:{padding:"12px",textAlign:"right",fontSize:"13px",fontWeight:"600"},children:"Output Tokens"}),(0,re.jsx)("th",{style:{padding:"12px",textAlign:"right",fontSize:"13px",fontWeight:"600"},children:"Total Cost"})]})}),(0,re.jsx)("tbody",{children:0===Object.keys(a.by_model).length?(0,re.jsx)("tr",{children:(0,re.jsx)("td",{colSpan:"5",style:{padding:"20px",textAlign:"center",color:"#646970"},children:"No cost data available yet. Process some images to see statistics."})}):Object.entries(a.by_model).map(function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,n)||function(t,e){if(t){if("string"==typeof t)return se(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1];return(0,re.jsxs)("tr",{style:{borderBottom:"1px solid #c3c4c7"},children:[(0,re.jsx)("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"500"},children:o}),(0,re.jsx)("td",{style:{padding:"12px",textAlign:"right",fontSize:"13px"},children:a.jobs.toLocaleString()}),(0,re.jsx)("td",{style:{padding:"12px",textAlign:"right",fontSize:"13px",color:"#646970"},children:a.input_tokens.toLocaleString()}),(0,re.jsx)("td",{style:{padding:"12px",textAlign:"right",fontSize:"13px",color:"#646970"},children:a.output_tokens.toLocaleString()}),(0,re.jsxs)("td",{style:{padding:"12px",textAlign:"right",fontSize:"13px",fontWeight:"600",color:"#2271b1"},children:["$",a.total_cost.toFixed(6)]})]},o)})}),Object.keys(a.by_model).length>0&&(0,re.jsx)("tfoot",{children:(0,re.jsxs)("tr",{style:{background:"#f6f7f7",borderTop:"2px solid #c3c4c7"},children:[(0,re.jsx)("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:"Total"}),(0,re.jsx)("td",{style:{padding:"12px",textAlign:"right",fontSize:"13px",fontWeight:"600"},children:a.total_jobs.toLocaleString()}),(0,re.jsx)("td",{colSpan:"2"}),(0,re.jsxs)("td",{style:{padding:"12px",textAlign:"right",fontSize:"14px",fontWeight:"700",color:"#2271b1"},children:["$",a.total_cost.toFixed(6)]})]})})]})]}),(0,re.jsxs)("div",{style:{marginTop:"20px",padding:"12px",background:"#f9f9f9",border:"1px solid #c3c4c7",borderRadius:"4px",fontSize:"12px",color:"#646970"},children:[(0,re.jsx)("strong",{children:"Note:"})," Costs are calculated based on current model pricing and actual token usage. Pricing is updated daily from external sources."]})]}):(0,re.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,re.jsx)(o.Spinner,{})})})}):null},de=function(t){var e=t.onAddImage;return(0,re.jsxs)("div",{className:"ai-media-library-header",style:{display:"flex",alignItems:"center",marginBottom:"20px",gap:"20px"},children:[(0,re.jsx)("h1",{style:{margin:0,fontSize:"23px",fontWeight:"400",lineHeight:"1.3"},children:"AI Media Library"}),(0,re.jsxs)(o.Button,{variant:"primary",onClick:e,style:{display:"inline-flex",alignItems:"center",gap:"6px"},children:[(0,re.jsx)("span",{className:"dashicons dashicons-plus-alt2",style:{fontSize:"18px"}}),"Add Image"]})]})};function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function he(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach(function(e){ye(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ye(t,e,n){return(e=function(t){var e=function(t){if("object"!=fe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fe(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function me(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ve(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ve(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const ge=function(t){var e,n=t.label,o=t.value,a=t.options,i=t.onChange,l=me((0,r.useState)(!1),2),c=l[0],s=l[1],u=me((0,r.useState)(!1),2),d=u[0],f=u[1];return(0,re.jsxs)("div",{className:"components-base-control",children:[(0,re.jsx)("label",{className:"components-base-control__label",style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#1d2327",lineHeight:"1.4"},children:n}),(0,re.jsx)("select",{value:o,onChange:function(t){return i(t.target.value)},onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},onFocus:function(){return f(!0)},onBlur:function(){return f(!1)},style:(e={minHeight:"38px",padding:"8px 32px 8px 12px",fontSize:"14px",lineHeight:"1.4",border:"1px solid #8c8f94",borderRadius:"3px",background:"#fff",color:"#1d2327",boxSizing:"border-box",appearance:"none",backgroundImage:"url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M5%206l5%205%205-5%202%201-7%207-7-7%202-1z%22%20fill%3D%22%232c3338%22%2F%3E%3C%2Fsvg%3E')",backgroundRepeat:"no-repeat",backgroundPosition:"right 8px top 50%",backgroundSize:"20px 20px",transition:"all 0.2s ease",cursor:"pointer",width:"100%"},d?he(he({},e),{},{borderColor:"#2271b1",outline:"2px solid transparent",boxShadow:"0 0 0 1px #2271b1, 0 2px 4px rgba(34, 113, 177, 0.1)",backgroundColor:"#fff"}):c?he(he({},e),{},{borderColor:"#2271b1",backgroundColor:"#f9f9f9"}):e),children:a.map(function(t){return(0,re.jsx)("option",{value:t.value,children:t.label},t.value)})})]})},be=function(t){var e=t.searchInput,n=t.onSearchChange,r=t.onSearch,a=t.onSearchKeyDown,i=t.statusFilter,l=t.onStatusFilterChange,c=t.statusFilterOptions,s=t.attachmentFilter,u=t.onAttachmentFilterChange,d=t.attachmentFilterOptions;return(0,re.jsx)("div",{className:"ai-media-library-toolbar",children:(0,re.jsxs)("div",{className:"ai-media-library-filters",style:{alignItems:"baseline"},children:[(0,re.jsxs)("div",{className:"search-control-wrapper",children:[(0,re.jsx)(o.TextControl,{label:"Search",value:e,onChange:n,onKeyDown:a,placeholder:"Search filename, ALT text, caption..."}),(0,re.jsx)(o.Button,{variant:"primary",onClick:r,className:"search-button",style:{marginBottom:"9px"},children:"Search"})]}),(0,re.jsx)("div",{style:{flex:"0 0 auto",minWidth:"200px"},children:(0,re.jsx)(ge,{label:"Status",value:i,options:c,onChange:l})}),(0,re.jsx)("div",{style:{flex:"0 0 auto",minWidth:"200px"},children:(0,re.jsx)(ge,{label:"Attachment",value:s,options:d,onChange:u})})]})})},xe=function(t){var e=t.selectedIds,n=t.batchProcessing,r=t.onBatchAnalyze,a=t.onBulkDelete,i=t.totalCost,l=t.loadingCosts,c=t.onShowCostModal,s=t.onLoadCostStats;return(0,re.jsxs)("div",{className:"ai-media-library-bulk-actions",children:[e.length>0?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(o.Button,{variant:"primary",onClick:function(){return r("selected")},disabled:n,isBusy:n,children:n?"Processing...":"Analyze Selected (".concat(e.length,")")}),(0,re.jsxs)(o.Button,{variant:"secondary",onClick:a,disabled:n,style:{color:"#b32d2e",borderColor:"#b32d2e",marginLeft:"8px"},children:["Bulk Delete (",e.length,")"]})]}):(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(o.Button,{variant:"secondary",onClick:function(){return r("missing_metadata")},disabled:n,children:"Analyze Missing Metadata"}),(0,re.jsx)(o.Button,{variant:"secondary",onClick:function(){return r("all")},disabled:n,children:"Analyze All Images"})]}),(0,re.jsxs)("button",{type:"button",onClick:function(){s(),c()},style:{marginLeft:"auto",padding:"8px 16px",background:"#f0f6fc",border:"1px solid #2271b1",borderRadius:"4px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:function(t){t.currentTarget.style.background="#e5f2fa",t.currentTarget.style.borderColor="#135e96"},onMouseLeave:function(t){t.currentTarget.style.background="#f0f6fc",t.currentTarget.style.borderColor="#2271b1"},children:[(0,re.jsx)("span",{className:"dashicons dashicons-money-alt",style:{color:"#2271b1",fontSize:"18px",width:"18px",height:"18px"}}),(0,re.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,re.jsx)("span",{style:{fontSize:"11px",color:"#646970",fontWeight:"500",textTransform:"uppercase",letterSpacing:"0.5px",lineHeight:"1.2"},children:"Total Cost"}),(0,re.jsx)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#1d2327",lineHeight:"1.2"},children:l?"...":"$".concat(i.toFixed(4))})]})]})]})},je=function(t){var e,n=t.attachment,r=t.onMouseEnter,o=t.onMouseLeave;return(0,re.jsx)("td",{className:"thumbnail-column",onMouseEnter:r,onMouseLeave:o,children:(0,re.jsx)("a",{href:"/wp-admin/post.php?post=".concat(n.id,"&action=edit"),target:"_blank",rel:"noopener noreferrer",style:{display:"block",cursor:"pointer"},children:null!==(e=n.media_details)&&void 0!==e&&null!==(e=e.sizes)&&void 0!==e&&null!==(e=e.thumbnail)&&void 0!==e&&e.source_url?(0,re.jsx)("img",{src:n.media_details.sizes.thumbnail.source_url,alt:n.alt_text||"",style:{width:"60px",height:"60px",objectFit:"cover"}}):(0,re.jsx)("div",{className:"placeholder-image",style:{width:"60px",height:"60px",background:"#ddd"}})})})};function Se(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return we(s,"_invoke",function(n,r,o){var a,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,l=0,c=t,f.n=n,i}};function p(n,r){for(l=n,c=r,e=0;!d&&s&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,c=h;(e=l<2?t:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,l<2&&(l=0)}else 1===l&&(e=a.return)&&e.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=t}else if((e=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(e){a=t,l=1,c=e}finally{s=1}}return{value:e,done:d}}}(n,o,a),!0),s}var i={};function l(){}function c(){}function s(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(we(e={},r,function(){return this}),e),d=s.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,we(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=s,we(d,"constructor",s),we(s,"constructor",c),c.displayName="GeneratorFunction",we(s,o,"GeneratorFunction"),we(d),we(d,o,"Generator"),we(d,r,function(){return this}),we(d,"toString",function(){return"[object Generator]"}),(Se=function(){return{w:a,m:f}})()}function we(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}we=function(t,e,n,r){function a(e,n){we(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},we(t,e,n,r)}function Oe(t,e,n,r,o,a,i){try{var l=t[a](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}const Ae=function(t){var e,n,r,o,a,l,c,s,d,f=t.attachment,p=t.editingTitle,h=t.savingTitle,y=t.queueStatus,m=t.onTitleClick,v=t.onTitleChange,g=t.onTitleKeyDown,b=t.onTitleSave,x=t.onLoadAllAttachments,j="processed"===(null===(e=f.meta)||void 0===e?void 0:e._ai_media_status),S=(null===(n=f.meta)||void 0===n?void 0:n._ai_media_draft_title)||"",w=u(null===(r=f.title)||void 0===r?void 0:r.rendered)||"",O=j&&S?S:w,A=ne(f,y),C=function(){var t,e=(t=Se().m(function t(e){var n,r;return Se().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.preventDefault(),e.stopPropagation(),confirm('Are you sure you want to delete "'.concat(u(null===(n=f.title)||void 0===n?void 0:n.rendered)||"Untitled",'" permanently?'))){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,i()({path:"/wp/v2/media/".concat(f.id,"?force=true"),method:"DELETE"});case 2:x(),t.n=4;break;case 3:t.p=3,r=t.v,alert("Error deleting image: "+r.message);case 4:return t.a(2)}},t,null,[[1,3]])}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Oe(a,r,o,i,l,"next",t)}function l(t){Oe(a,r,o,i,l,"throw",t)}i(void 0)})});return function(t){return e.apply(this,arguments)}}();return(0,re.jsx)("td",{children:p&&p.id===f.id?(0,re.jsx)("input",{type:"text",value:p.value,onChange:function(t){return v(t.target.value)},onKeyDown:g,onBlur:b,disabled:h,autoFocus:!0,onClick:function(t){return t.stopPropagation()},style:{width:"100%",padding:"4px 8px",border:"1px solid #8c8f94",borderRadius:"2px",fontSize:"13px",fontWeight:"normal"}}):(0,re.jsxs)("div",{children:[(0,re.jsx)("strong",{style:{cursor:A?"not-allowed":"pointer"},onClick:function(){return!A&&m(f)},children:O?j&&S?(0,re.jsxs)("span",{style:{backgroundColor:"#fff3cd",padding:"2px 4px",borderRadius:"2px",display:"inline-block"},children:[(0,re.jsx)("strong",{style:{color:"#856404",fontSize:"11px",marginRight:"4px"},children:"DRAFT:"}),O]}):O||"Untitled":(0,re.jsx)("em",{style:{color:"#999",fontWeight:"normal"},children:"Click to add title"})}),(0,re.jsx)("br",{}),(0,re.jsx)("small",{children:(null===(o=f.source_url)||void 0===o?void 0:o.split("/").pop())||""}),(0,re.jsxs)("div",{className:"row-actions",children:[(0,re.jsxs)("span",{className:"edit",children:[(0,re.jsx)("a",{href:"/wp-admin/post.php?post=".concat(f.id,"&action=edit"),"aria-label":'Edit "'.concat(u(null===(a=f.title)||void 0===a?void 0:a.rendered)||"Untitled",'"'),children:"Edit"})," |"]}),(0,re.jsxs)("span",{className:"delete",children:[(0,re.jsx)("button",{type:"button",className:"button-link submitdelete",onClick:C,"aria-label":'Delete "'.concat(u(null===(l=f.title)||void 0===l?void 0:l.rendered)||"Untitled",'" permanently'),children:"Delete"})," |"]}),(0,re.jsxs)("span",{className:"view",children:[(0,re.jsx)("a",{href:f.source_url,target:"_blank",rel:"noopener noreferrer","aria-label":'View "'.concat(u(null===(c=f.title)||void 0===c?void 0:c.rendered)||"Untitled",'"'),children:"View"})," |"]}),(0,re.jsxs)("span",{className:"copy",children:[(0,re.jsx)("button",{type:"button",className:"button-link copy-attachment-url",onClick:function(t){t.stopPropagation(),navigator.clipboard.writeText(f.source_url);var e=t.target.nextElementSibling;e&&(e.classList.remove("hidden"),setTimeout(function(){return e.classList.add("hidden")},2e3))},"aria-label":'Copy "'.concat(u(null===(s=f.title)||void 0===s?void 0:s.rendered)||"Untitled",'" URL to clipboard'),children:"Copy URL"}),(0,re.jsx)("span",{className:"success hidden","aria-hidden":"true",children:"Copied!"})," |"]}),(0,re.jsx)("span",{className:"download",children:(0,re.jsx)("a",{href:f.source_url,"aria-label":'Download "'.concat(u(null===(d=f.title)||void 0===d?void 0:d.rendered)||"Untitled",'"'),download:!0,children:"Download"})})]})]})})},Ce=function(t){var e,n,r=t.attachment,o=t.editingAlt,a=t.savingAlt,i=t.queueStatus,l=t.onAltClick,c=t.onAltChange,s=t.onAltKeyDown,u=t.onAltSave,d="processed"===(null===(e=r.meta)||void 0===e?void 0:e._ai_media_status),f=(null===(n=r.meta)||void 0===n?void 0:n._ai_media_draft_alt)||"",p=r.alt_text||"",h=d&&f?f:p,y=ne(r,i);return(0,re.jsx)("td",{style:{cursor:o&&o.id===r.id?"default":"pointer"},children:o&&o.id===r.id?(0,re.jsx)("textarea",{value:o.value,onChange:function(t){return c(t.target.value)},onKeyDown:s,onBlur:u,disabled:a,autoFocus:!0,rows:2,onClick:function(t){return t.stopPropagation()},style:{width:"100%",padding:"4px 8px",border:"1px solid #8c8f94",borderRadius:"2px",fontSize:"13px",resize:"vertical",fontFamily:"inherit"}}):(0,re.jsx)("span",{onClick:function(){return l(r)},style:{display:"block",padding:"4px 0",cursor:y?"not-allowed":"pointer",opacity:y?.6:1},children:y?(0,re.jsx)("em",{style:{color:"#0071a1"},children:"Processing..."}):h?d&&f?(0,re.jsxs)("span",{style:{backgroundColor:"#fff3cd",padding:"2px 4px",borderRadius:"2px",display:"inline-block"},children:[(0,re.jsx)("strong",{style:{color:"#856404",fontSize:"11px",marginRight:"4px"},children:"DRAFT:"}),h]}):h:(0,re.jsx)("em",{style:{color:"#999"},children:"Click to add ALT text"})})})},Pe=function(t){var e,n,r,o=t.attachment,a=t.editingCaption,i=t.savingCaption,l=t.queueStatus,c=t.onCaptionClick,s=t.onCaptionChange,d=t.onCaptionKeyDown,f=t.onCaptionSave,p="processed"===(null===(e=o.meta)||void 0===e?void 0:e._ai_media_status),h=(null===(n=o.meta)||void 0===n?void 0:n._ai_media_draft_caption)||"",y=u(null===(r=o.caption)||void 0===r?void 0:r.rendered)||"",m=p&&h?h:y,v=ne(o,l);return(0,re.jsx)("td",{style:{cursor:a&&a.id===o.id?"default":"pointer"},children:a&&a.id===o.id?(0,re.jsx)("textarea",{value:a.value,onChange:function(t){return s(t.target.value)},onKeyDown:d,onBlur:f,disabled:i,autoFocus:!0,rows:3,onClick:function(t){return t.stopPropagation()},style:{width:"100%",padding:"4px 8px",border:"1px solid #8c8f94",borderRadius:"2px",fontSize:"13px",resize:"vertical",fontFamily:"inherit"}}):(0,re.jsx)("span",{onClick:function(){return c(o)},style:{display:"block",padding:"4px 0",cursor:v?"not-allowed":"pointer",opacity:v?.6:1,color:"#666",fontSize:"13px"},children:v?(0,re.jsx)("em",{style:{color:"#0071a1"},children:"Processing..."}):m?p&&h?(0,re.jsxs)("span",{style:{backgroundColor:"#fff3cd",padding:"2px 4px",borderRadius:"2px",display:"inline-block"},children:[(0,re.jsx)("strong",{style:{color:"#856404",fontSize:"11px",marginRight:"4px"},children:"DRAFT:"}),m]}):m:(0,re.jsx)("em",{style:{color:"#999"},children:"Click to add caption"})})})},_e=function(t){var e,n,r,o,a,i,l=t.attachment,c=t.editingStatus,s=t.savingStatus,u=t.queueStatus,d=t.onStatusClick,f=t.onStatusChange,p=t.onStatusSave,h=t.onApprove,y=ne(l,u);return(0,re.jsx)("td",{children:c&&c.id===l.id?(0,re.jsxs)("select",{value:c.value,onChange:function(t){return f(t.target.value)},onBlur:p,disabled:s,autoFocus:!0,onClick:function(t){return t.stopPropagation()},style:{padding:"4px 8px",border:"1px solid #8c8f94",borderRadius:"2px",fontSize:"13px"},children:[(0,re.jsx)("option",{value:"pending",children:"Pending"}),(0,re.jsx)("option",{value:"processed",children:"Processed"}),(0,re.jsx)("option",{value:"approved",children:"Approved"})]}):(0,re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,re.jsx)("span",{className:"ai-media-status ai-media-status-".concat(null!==(e=u[l.id])&&void 0!==e&&e.in_queue?"processing":(null===(n=l.meta)||void 0===n?void 0:n._ai_media_status)||"pending"),onClick:function(){return d(l)},style:{cursor:y?"not-allowed":"pointer",opacity:y?.8:1},children:(i=null!==(o=u[l.id])&&void 0!==o&&o.in_queue?"processing":(null===(a=l.meta)||void 0===a?void 0:a._ai_media_status)||"pending",i.charAt(0).toUpperCase()+i.slice(1))}),"processed"===(null===(r=l.meta)||void 0===r?void 0:r._ai_media_status)&&(0,re.jsx)("input",{type:"checkbox",onChange:function(){return h(l.id)},disabled:s||y,title:"Approve"})]})})},ke=function(t){var e=t.attachment,n=t.attachingTo,r=t.onAttachToPost,o=t.onDetach,a=e.post||e.parent||0,i=e.parent_info;return n===e.id?(0,re.jsx)("td",{children:(0,re.jsx)("span",{style:{color:"#999",fontSize:"13px"},children:"Attaching..."})}):a&&0!==a?i?(0,re.jsx)("td",{children:(0,re.jsxs)("div",{style:{fontSize:"13px"},children:[(0,re.jsx)("a",{href:"/wp-admin/post.php?post=".concat(i.id,"&action=edit"),target:"_blank",rel:"noopener noreferrer",style:{color:"#2271b1",textDecoration:"none"},children:i.title}),(0,re.jsx)("br",{}),(0,re.jsx)("button",{type:"button",className:"button-link",onClick:function(){return o(e.id)},style:{color:"#b32d2e",textDecoration:"none",background:"none",border:"none",padding:0,cursor:"pointer",fontSize:"12px",marginTop:"4px",fontFamily:"inherit"},children:"Detach"})]})}):(0,re.jsx)("td",{children:(0,re.jsxs)("div",{style:{fontSize:"13px",color:"#666"},children:["Post #",a,(0,re.jsx)("br",{}),(0,re.jsx)("button",{type:"button",className:"button-link",onClick:function(){return o(e.id)},style:{color:"#b32d2e",textDecoration:"none",background:"none",border:"none",padding:0,cursor:"pointer",fontSize:"12px",marginTop:"4px",fontFamily:"inherit"},children:"Detach"})]})}):(0,re.jsx)("td",{children:(0,re.jsx)("button",{type:"button",className:"button-link",onClick:function(){return r(e.id)},style:{color:"#2271b1",textDecoration:"none",background:"none",border:"none",padding:0,cursor:"pointer",fontSize:"13px",fontFamily:"inherit"},children:"Attach to post/page"})})},Te=function(t){var e=t.attachment;return(0,re.jsx)("td",{children:e.model?(0,re.jsx)("div",{style:{fontSize:"11px",color:"#666"},children:e.model}):(0,re.jsx)("span",{style:{color:"#999"},children:""})})},Ie=function(t){var e=t.attachment;return(0,re.jsx)("td",{children:null!==e.score&&void 0!==e.score?(0,re.jsxs)("span",{className:e.score>=.85?"score-high":e.score>=.7?"score-medium":"score-low",style:{display:"inline-block",padding:"4px 8px",borderRadius:"3px",fontSize:"13px",fontWeight:"600",backgroundColor:e.score>=.85?"#d4edda":e.score>=.7?"#fff3cd":"#f8d7da",color:e.score>=.85?"#155724":e.score>=.7?"#856404":"#721c24"},children:[(100*e.score).toFixed(0),"%"]}):(0,re.jsx)("span",{style:{color:"#999"},children:""})})},Ee=function(t){var e,n,r=t.attachment,a=t.queueStatus,i=t.processingIds,l=t.onAnalyze,c=(null===(e=r.meta)||void 0===e?void 0:e._ai_media_status)||"pending",s=(null===(n=a[r.id])||void 0===n?void 0:n.in_queue)||!1,u=i.includes(r.id),d=s||u;return(0,re.jsx)("td",{children:(0,re.jsx)(o.Button,{variant:"secondary",size:"small",onClick:function(){return l(r.id)},disabled:d,isBusy:d,children:"processing"===c&&s?"Processing...":d?"Analyzing...":"Analyze"})})},De=function(t){var e=t.attachment,n=t.isSelected,r=t.onToggleSelection,o=t.isColumnVisible,a=t.editingTitle,i=t.savingTitle,l=t.editingAlt,c=t.savingAlt,s=t.editingCaption,u=t.savingCaption,d=t.editingStatus,f=t.savingStatus,p=t.queueStatus,h=t.processingIds,y=t.attachingTo,m=t.onTitleClick,v=t.onTitleChange,g=t.onTitleKeyDown,b=t.onTitleSave,x=t.onLoadAllAttachments,j=t.onAltClick,S=t.onAltChange,w=t.onAltKeyDown,O=t.onAltSave,A=t.onCaptionClick,C=t.onCaptionChange,P=t.onCaptionKeyDown,_=t.onCaptionSave,k=t.onStatusClick,T=t.onStatusChange,I=t.onStatusSave,E=t.onApprove,D=t.onAttachToPost,N=t.onDetach,F=t.onAnalyze,z=t.onThumbnailEnter,M=t.onThumbnailLeave;return(0,re.jsxs)("tr",{children:[(0,re.jsx)("th",{className:"check-column",onClick:function(){return r(e.id)},style:{cursor:"pointer"},children:(0,re.jsx)("input",{type:"checkbox",checked:n,onChange:function(t){return t.stopPropagation()},onClick:function(){return r(e.id)}})}),(0,re.jsx)(je,{attachment:e,onMouseEnter:function(t){return z(t,e)},onMouseLeave:M}),o("file")&&(0,re.jsx)(Ae,{attachment:e,editingTitle:a,savingTitle:i,queueStatus:p,onTitleClick:m,onTitleChange:v,onTitleKeyDown:g,onTitleSave:b,onLoadAllAttachments:x}),o("alt")&&(0,re.jsx)(Ce,{attachment:e,editingAlt:l,savingAlt:c,queueStatus:p,onAltClick:j,onAltChange:S,onAltKeyDown:w,onAltSave:O}),o("caption")&&(0,re.jsx)(Pe,{attachment:e,editingCaption:s,savingCaption:u,queueStatus:p,onCaptionClick:A,onCaptionChange:C,onCaptionKeyDown:P,onCaptionSave:_}),o("status")&&(0,re.jsx)(_e,{attachment:e,editingStatus:d,savingStatus:f,queueStatus:p,onStatusClick:k,onStatusChange:T,onStatusSave:I,onApprove:E}),o("attached_to")&&(0,re.jsx)(ke,{attachment:e,attachingTo:y,onAttachToPost:D,onDetach:N}),o("provider")&&(0,re.jsx)(Te,{attachment:e}),o("score")&&(0,re.jsx)(Ie,{attachment:e}),(0,re.jsx)(Ee,{attachment:e,queueStatus:p,processingIds:h,onAnalyze:F})]},e.id)},Ne=function(t){var e=t.currentPage,n=t.totalPages,r=t.totalItems,a=t.onPageChange;return n<=1?null:(0,re.jsxs)("div",{className:"tablenav-pages",children:[(0,re.jsxs)("span",{className:"displaying-num",children:[r," ",1===r?"item":"items"]}),(0,re.jsxs)("span",{className:"pagination-links",children:[(0,re.jsx)(o.Button,{className:"first-page button",disabled:1===e,onClick:function(){return a(1)},"aria-label":"First page",children:""}),(0,re.jsx)(o.Button,{className:"prev-page button",disabled:1===e,onClick:function(){return a(e-1)},"aria-label":"Previous page",children:""}),(0,re.jsx)("span",{className:"paging-input",children:(0,re.jsxs)("span",{className:"tablenav-paging-text",children:[e," of ",(0,re.jsx)("span",{className:"total-pages",children:n})]})}),(0,re.jsx)(o.Button,{className:"next-page button",disabled:e===n,onClick:function(){return a(e+1)},"aria-label":"Next page",children:""}),(0,re.jsx)(o.Button,{className:"last-page button",disabled:e===n,onClick:function(){return a(n)},"aria-label":"Last page",children:""})]})]})},Fe=function(t){var e=t.paginatedAttachments,n=t.selectedIds,r=t.onSelectAll,o=t.onToggleSelection,a=t.isColumnVisible,i=t.currentPage,l=t.totalPages,c=t.totalItems,s=t.onPageChange,u=t.editingTitle,d=t.savingTitle,f=t.editingAlt,p=t.savingAlt,h=t.editingCaption,y=t.savingCaption,m=t.editingStatus,v=t.savingStatus,g=t.queueStatus,b=t.processingIds,x=t.attachingTo,j=t.onTitleClick,S=t.onTitleChange,w=t.onTitleKeyDown,O=t.onTitleSave,A=t.onLoadAllAttachments,C=t.onAltClick,P=t.onAltChange,_=t.onAltKeyDown,k=t.onAltSave,T=t.onCaptionClick,I=t.onCaptionChange,E=t.onCaptionKeyDown,D=t.onCaptionSave,N=t.onStatusClick,F=t.onStatusChange,z=t.onStatusSave,M=t.onApprove,B=t.onAttachToPost,L=t.onDetach,G=t.onAnalyze,U=t.onThumbnailEnter,R=t.onThumbnailLeave,K=3+(a("file")?1:0)+(a("alt")?1:0)+(a("caption")?1:0)+(a("status")?1:0)+(a("attached_to")?1:0)+(a("provider")?1:0)+(a("score")?1:0);return(0,re.jsxs)("div",{className:"ai-media-library-table",children:[l>1&&(0,re.jsx)("div",{className:"tablenav top",children:(0,re.jsx)(Ne,{currentPage:i,totalPages:l,totalItems:c,onPageChange:s})}),(0,re.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,re.jsx)("thead",{children:(0,re.jsxs)("tr",{children:[(0,re.jsx)("th",{className:"check-column",onClick:r,style:{cursor:"pointer"},children:(0,re.jsx)("input",{type:"checkbox",checked:e.length>0&&e.every(function(t){return n.includes(t.id)}),onChange:function(t){return t.stopPropagation()},onClick:r})}),(0,re.jsx)("th",{className:"thumbnail-column",children:"Image"}),a("file")&&(0,re.jsx)("th",{children:"File"}),a("alt")&&(0,re.jsx)("th",{children:"ALT text"}),a("caption")&&(0,re.jsx)("th",{children:"Caption"}),a("status")&&(0,re.jsx)("th",{children:"Status"}),a("attached_to")&&(0,re.jsx)("th",{children:"Attached to"}),a("provider")&&(0,re.jsx)("th",{children:"Provider"}),a("score")&&(0,re.jsx)("th",{children:"Score"}),(0,re.jsx)("th",{children:"Actions"})]})}),(0,re.jsx)("tbody",{children:0===e.length?(0,re.jsx)("tr",{children:(0,re.jsx)("td",{colSpan:K,style:{textAlign:"center",padding:"2em"},children:"No images found. Upload some images to get started."})}):e.map(function(t){return(0,re.jsx)(De,{attachment:t,isSelected:n.includes(t.id),onToggleSelection:o,isColumnVisible:a,editingTitle:u,savingTitle:d,editingAlt:f,savingAlt:p,editingCaption:h,savingCaption:y,editingStatus:m,savingStatus:v,queueStatus:g,processingIds:b,attachingTo:x,onTitleClick:j,onTitleChange:S,onTitleKeyDown:w,onTitleSave:O,onLoadAllAttachments:A,onAltClick:C,onAltChange:P,onAltKeyDown:_,onAltSave:k,onCaptionClick:T,onCaptionChange:I,onCaptionKeyDown:E,onCaptionSave:D,onStatusClick:N,onStatusChange:F,onStatusSave:z,onApprove:M,onAttachToPost:B,onDetach:L,onAnalyze:G,onThumbnailEnter:U,onThumbnailLeave:R},t.id)})})]}),l>1&&(0,re.jsx)("div",{className:"tablenav bottom",children:(0,re.jsx)(Ne,{currentPage:i,totalPages:l,totalItems:c,onPageChange:s})})]})};function ze(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const Me=function(){console.log("[MediaLibrary] Component rendering...");var t=function(){var t=b((0,r.useState)([]),2),e=t[0],n=t[1],o=b((0,r.useState)(0),2),a=o[0],c=o[1],d=b((0,r.useState)(0),2),f=d[0],h=d[1],m=b((0,r.useState)(!0),2),v=m[0],x=m[1],j=b((0,r.useState)(null),2),S=j[0],w=j[1],O=function(){var t=(0,r.useRef)(new Map),e=(0,r.useCallback)(function(t,e,n){var r=new URLSearchParams({page:t,per_page:e,status:n.status||"all",attachment_filter:n.attachmentFilter||"all",search:n.search||""});return"/ai-media/v1/library?".concat(r.toString())},[]),n=(0,r.useCallback)(function(t,e,n){return"page_".concat(t,"_").concat(e,"_").concat(n.status,"_").concat(n.attachmentFilter,"_").concat(n.search)},[]),o=(0,r.useCallback)(function(){var r,o=(r=l().m(function r(o,a,c){var s,u,d,f;return l().w(function(r){for(;;)switch(r.n){case 0:if(s=n(o,a,c),!t.current.has(s)){r.n=1;break}return console.log("[Cache] HIT for ".concat(s)),r.a(2,t.current.get(s));case 1:return console.log("[Cache] MISS for ".concat(s,", fetching...")),u=e(o,a,c),r.n=2,i()({path:u,method:"GET"});case 2:return d=r.v,t.current.set(s,d),t.current.size>5&&(f=t.current.keys().next().value,t.current.delete(f),console.log("[Cache] Evicted ".concat(f," (size limit reached)"))),r.a(2,d)}},r)}),function(){var t=this,e=arguments;return new Promise(function(n,o){var a=r.apply(t,e);function i(t){s(a,n,o,i,l,"next",t)}function l(t){s(a,n,o,i,l,"throw",t)}i(void 0)})});return function(t,e,n){return o.apply(this,arguments)}}(),[e,n]),a=(0,r.useCallback)(function(e,r,a,i){var l=[];if(e>1){var c=n(e-1,a,i);t.current.has(c)||l.push(o(e-1,a,i))}if(e<r){var s=n(e+1,a,i);t.current.has(s)||l.push(o(e+1,a,i))}if(e+2<=r){var u=n(e+2,a,i);t.current.has(u)||l.push(o(e+2,a,i))}l.length>0&&(console.log("[Prefetch] Loading ".concat(l.length," pages in background")),Promise.all(l).catch(function(t){console.warn("[Prefetch] Failed:",t)}))},[n,o]),c=(0,r.useCallback)(function(){console.log("[Cache] Clearing all cache"),t.current.clear()},[]),u=(0,r.useCallback)(function(){return t.current.size},[]);return{loadPage:o,prefetchAdjacentPages:a,clearCache:c,getCacheSize:u}}(),A=O.loadPage,C=O.prefetchAdjacentPages,P=O.clearCache,_=(0,r.useCallback)(function(){var t=g(y().m(function t(e,r,o){var a,i;return y().w(function(t){for(;;)switch(t.p=t.n){case 0:return console.log("[useAttachments] Loading page",e,"with filters:",o),t.p=1,x(!0),w(null),t.n=2,A(e,r,o);case 2:a=t.v,console.log("[useAttachments] Loaded:",a.items.length,"items, total:",a.total),n(a.items),c(a.total),h(a.total_pages),C(e,a.total_pages,r,o),x(!1),t.n=4;break;case 3:t.p=3,i=t.v,console.error("[useAttachments] Error loading library:",i),w(i.message),x(!1);case 4:return t.a(2)}},t,null,[[1,3]])}));return function(e,n,r){return t.apply(this,arguments)}}(),[A,C]),k=(0,r.useCallback)(function(){var t=g(y().m(function t(e){var r,o,a,l,c,s,u,d=arguments;return y().w(function(t){for(;;)switch(t.p=t.n){case 0:return r=d.length>1&&void 0!==d[1]?d[1]:null,t.p=1,t.n=2,i()({path:"/wp/v2/media/".concat(e),method:"GET"});case 2:if(o=t.v,r){t.n=6;break}return r={provider:null,model:null,score:null},t.p=3,t.n=4,i()({path:"/ai-media/v1/jobs?attachment_ids=".concat(e),method:"GET"});case 4:l=t.v,(c=null===(a=l.jobs)||void 0===a?void 0:a.filter(function(t){return t.attachment_id==e}).sort(function(t,e){return new Date(e.created_at)-new Date(t.created_at)})[0])&&(r={provider:c.provider||null,model:c.model||null,score:null!==c.score?parseFloat(c.score):null}),t.n=6;break;case 5:t.p=5,s=t.v,console.warn("[useAttachments] Failed to load job data:",s);case 6:n(function(t){return t.map(function(t){return t.id===e?p(p({},o),{},{provider:r.provider,model:r.model,score:r.score}):t})}),t.n=8;break;case 7:t.p=7,u=t.v,console.error("[useAttachments] Error refreshing attachment:",u);case 8:return t.a(2)}},t,null,[[3,5],[1,7]])}));return function(e){return t.apply(this,arguments)}}(),[]),T=(0,r.useCallback)(function(){var t=g(y().m(function t(e,r){var o,a,l,c,s;return y().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.n=1,i()({path:"/wp/v2/media/".concat(e),method:"POST",data:{post:r}});case 1:return o=null,t.p=2,t.n=3,i()({path:"/wp/v2/posts/".concat(r),method:"GET"});case 3:l=t.v,o={id:l.id,title:u(null===(a=l.title)||void 0===a?void 0:a.rendered)||"Untitled",type:l.type||"post"},t.n=8;break;case 4:return t.p=4,t.v,t.p=5,t.n=6,i()({path:"/wp/v2/pages/".concat(r),method:"GET"});case 6:s=t.v,o={id:s.id,title:u(null===(c=s.title)||void 0===c?void 0:c.rendered)||"Untitled",type:s.type||"page"},t.n=8;break;case 7:t.p=7,t.v,o={id:r,title:"(Unknown)",type:"unknown"};case 8:n(function(t){return t.map(function(t){return t.id===e?p(p({},t),{},{post:r,parent:r,parent_info:o}):t})});case 9:return t.a(2)}},t,null,[[5,7],[2,4]])}));return function(e,n){return t.apply(this,arguments)}}(),[]),I=(0,r.useCallback)(function(){var t=g(y().m(function t(e){var r;return y().w(function(t){for(;;)switch(t.p=t.n){case 0:if(confirm("Detach this image from its post/page?")){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,i()({path:"/wp/v2/media/".concat(e),method:"POST",data:{post:0}});case 2:n(function(t){return t.map(function(t){return t.id===e?p(p({},t),{},{post:0,parent:0,parent_info:null}):t})}),t.n=4;break;case 3:t.p=3,r=t.v,alert("Error detaching image: "+r.message);case 4:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),[]);return{items:e,totalItems:a,totalPages:f,loading:v,error:S,loadLibrary:_,refreshAttachment:k,attachToParent:T,handleDetach:I,invalidateCache:(0,r.useCallback)(function(){console.log("[useAttachments] Invalidating cache"),P()},[P]),setItems:n,setLoading:x,setError:w}}();console.log("[MediaLibrary] Attachments data:",{loading:t.loading,error:t.error,count:t.items.length,total:t.totalItems});var e,n,a=function(){var t=I((0,r.useState)("all"),2),e=t[0],n=t[1],o=I((0,r.useState)("all"),2),a=o[0],i=o[1],l=I((0,r.useState)(""),2),c=l[0],s=l[1],u=I((0,r.useState)(""),2),d=u[0],f=u[1],p=function(){s(d)};return{statusFilter:e,setStatusFilter:n,attachmentFilter:a,setAttachmentFilter:i,searchQuery:c,setSearchQuery:s,searchInput:d,setSearchInput:f,handleSearch:p,handleSearchKeyDown:function(t){"Enter"===t.key&&p()}}}(),c=function(){var t,e=D((0,r.useState)(1),2),n=e[0],o=e[1],a=D((0,r.useState)((null===(t=window.aiMediaSEO)||void 0===t||null===(t=t.screenOptions)||void 0===t?void 0:t.perPage)||20),2),i=a[0],l=a[1];return{currentPage:n,perPage:i,goToPage:function(t){var e;o(t),null===(e=document.querySelector(".ai-media-library-table"))||void 0===e||e.scrollIntoView({behavior:"smooth"})},resetPage:function(){o(1)},setCurrentPage:o,setPerPage:l}}(),d=R(),f=Y(t.items,t.refreshAttachment),h=function(){var t=pt((0,r.useState)(0),2),e=t[0],n=t[1],o=pt((0,r.useState)(!1),2),a=o[0],l=o[1],c=pt((0,r.useState)(!1),2),s=c[0],u=c[1],d=pt((0,r.useState)(null),2),f=d[0],p=d[1],h=pt((0,r.useState)(null),2),y=h[0],m=h[1],v=function(){var t=ft(st().m(function t(){var e,r;return st().w(function(t){for(;;)switch(t.p=t.n){case 0:return console.log("[Frontend] loadTotalCost - Starting..."),l(!0),t.p=1,t.n=2,i()({path:"/ai-media/v1/costs/total",method:"GET"});case 2:e=t.v,console.log("[Frontend] loadTotalCost - Response:",e),n(e.total_cost||0),console.log("[Frontend] loadTotalCost - Set totalCost to:",e.total_cost||0),t.n=4;break;case 3:t.p=3,r=t.v,console.error("[Frontend] Failed to load total cost:",r);case 4:return t.p=4,l(!1),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(){return t.apply(this,arguments)}}(),g=function(){var t=ft(st().m(function t(){var e,n,r,o,a;return st().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Promise.all([i()({path:"/ai-media/v1/costs/stats",method:"GET"}),i()({path:"/ai-media/v1/costs/breakdown",method:"GET"})]);case 1:e=t.v,n=pt(e,2),r=n[0],o=n[1],p(r),m(o),t.n=3;break;case 2:t.p=2,a=t.v,console.error("Failed to load cost stats:",a);case 3:return t.a(2)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return(0,r.useEffect)(function(){v()},[]),{totalCost:e,loadingCosts:a,showCostModal:s,setShowCostModal:u,costStats:f,costBreakdown:y,loadTotalCost:v,loadCostStats:g,addCost:function(t){console.log("[useCostTracking] addCost called with:",t,"type:",ct(t)),n(function(e){var n=e+t;return console.log("[useCostTracking] addCost - Updating totalCost from",e,"to",n),n})}}}(),m=function(){var t,e,n,o=(e=(0,r.useState)((null===(t=window.aiMediaSEO)||void 0===t||null===(t=t.screenOptions)||void 0===t?void 0:t.hiddenColumns)||[]),n=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,n)||function(t,e){if(t){if("string"==typeof t)return yt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yt(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],i=o[1];return(0,r.useEffect)(function(){var t=function(t){i(t.detail.hiddenColumns)};return window.addEventListener("aiMediaColumnVisibilityChanged",t),function(){window.removeEventListener("aiMediaColumnVisibilityChanged",t)}},[]),{hiddenColumns:a,isColumnVisible:function(t){return!a.includes(t)}}}(),v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=Ct((0,r.useState)(!1),2),n=e[0],o=e[1],a=Ct((0,r.useState)([]),2),i=a[0],l=a[1],c=Ct((0,r.useState)(!1),2),s=c[0],u=c[1],d=Ct((0,r.useState)({}),2),f=d[0],p=d[1],h=Ct((0,r.useState)(!1),2),y=h[0],m=h[1],v=(0,r.useRef)(null),g=function(t){var e=t.filter(function(t){return t.type.startsWith("image/")});if(0!==e.length){l(function(t){return[].concat(At(t),At(e))});var n={};e.forEach(function(t){n[t.name]={status:"pending",progress:0,id:null}}),p(function(t){return wt(wt({},t),n)})}else alert("Please select image files only.")},b=function(){var e,n=(e=gt().m(function e(){var n,r,a,c;return gt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(0!==i.length&&!s){e.n=1;break}return e.a(2);case 1:u(!0),n=xt(i),e.p=2,a=gt().m(function t(){var e,n,o,a,i,l;return gt().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=r.value,t.p=1,p(function(t){return wt(wt({},t),{},Ot({},e.name,wt(wt({},t[e.name]),{},{status:"uploading",progress:0})))}),(n=new FormData).append("file",e),n.append("title",e.name.replace(/\.[^/.]+$/,"")),t.n=2,fetch(window.aiMediaSEO.wpApiUrl+"wp/v2/media",{method:"POST",headers:{"X-WP-Nonce":window.aiMediaSEO.nonce},body:n});case 2:if((o=t.v).ok){t.n=4;break}return t.n=3,o.json();case 3:throw a=t.v,new Error(a.message||"Upload failed: ".concat(o.statusText));case 4:return t.n=5,o.json();case 5:i=t.v,p(function(t){return wt(wt({},t),{},Ot({},e.name,{status:"completed",progress:100,id:i.id}))}),t.n=7;break;case 6:t.p=6,l=t.v,p(function(t){return wt(wt({},t),{},Ot({},e.name,{status:"failed",progress:0,id:null,error:l.message}))});case 7:return t.a(2)}},t,null,[[1,6]])}),n.s();case 3:if((r=n.n()).done){e.n=5;break}return e.d(vt(a()),4);case 4:e.n=3;break;case 5:e.n=7;break;case 6:e.p=6,c=e.v,n.e(c);case 7:return e.p=7,n.f(),e.f(7);case 8:u(!1),setTimeout(function(){p(function(e){return Object.values(e).every(function(t){return"completed"===t.status})&&Object.keys(e).length>0&&setTimeout(function(){o(!1),l([]),p({}),t&&t()},800),e})},100);case 9:return e.a(2)}},e,null,[[2,6,7,8]])}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(t){jt(a,r,o,i,l,"next",t)}function l(t){jt(a,r,o,i,l,"throw",t)}i(void 0)})});return function(){return n.apply(this,arguments)}}();return{uploadModalOpen:n,uploadFiles:i,uploading:s,uploadProgress:f,isDragging:y,fileInputRef:v,openUploadModal:function(){o(!0)},closeUploadModal:function(){s&&!confirm("Upload is in progress. Are you sure you want to cancel?")||(o(!1),l([]),p({}))},handleFileSelect:function(t){var e=Array.from(t.target.files);g(e)},handleFilesAdded:g,handleStartUpload:b,handleRemoveFile:function(t){l(function(e){return e.filter(function(e){return e.name!==t})}),p(function(e){var n=wt({},e);return delete n[t],n})},handleDragEnter:function(t){t.preventDefault(),t.stopPropagation(),m(!0)},handleDragLeave:function(t){t.preventDefault(),t.stopPropagation(),t.currentTarget===t.target&&m(!1)},handleDragOver:function(t){t.preventDefault(),t.stopPropagation()},handleDrop:function(t){t.preventDefault(),t.stopPropagation(),m(!1);var e=Array.from(t.dataTransfer.files);g(e)}}}(),x=(e=(0,r.useState)(null),n=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,n)||function(t,e){if(t){if("string"==typeof t)return ze(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),j=x[0],S=x[1],w=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ee(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useState)(t),2),o=n[0],a=n[1];return(0,r.useEffect)(function(){var n=setTimeout(function(){a(t)},e);return function(){clearTimeout(n)}},[t,e]),o}(a.searchInput,500),O=(0,r.useMemo)(function(){return{status:a.statusFilter,attachmentFilter:a.attachmentFilter,search:a.searchQuery}},[a.statusFilter,a.attachmentFilter,a.searchQuery]);(0,r.useEffect)(function(){console.log("[MediaLibrary] Loading library - page:",c.currentPage,"filters:",O),t.loadLibrary(c.currentPage,c.perPage,O)},[c.currentPage,c.perPage,O,t.loadLibrary]),(0,r.useEffect)(function(){w!==a.searchQuery&&(console.log("[MediaLibrary] Search changed:",w),t.invalidateCache(),a.setSearchQuery(w),c.resetPage())},[w,a.searchQuery]);var A=function(t){return ne(t,f.queueStatus)},C=function(t){var e=t.addProcessingId,n=t.removeProcessingId,o=t.refreshAttachment,a=t.addCost,l=t.processingIds,c=t.setAllAttachments,s=t.selectedIds,u=t.clearSelection,d=t.setAdminNotice,f=Lt((0,r.useState)(!1),2),p=f[0],h=f[1],y=Lt((0,r.useState)(null),2),m=y[0],v=y[1],g=(0,r.useRef)(!1),b=Lt((0,r.useState)(""),2),x=b[0],j=b[1],S=function(){var t=Bt(Et().m(function t(r){var s,u,d,f,p;return Et().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!l.includes(r)){t.n=1;break}return t.a(2);case 1:return e(r),c(function(t){return t.map(function(t){return t.id===r?Ft(Ft({},t),{},{meta:Ft(Ft({},t.meta),{},{_ai_media_status:"processing"}),alt_text:"Processing...",title:{rendered:"Processing..."},caption:{rendered:"Processing..."}}):t})}),t.p=2,t.n=3,i()({path:"/ai-media/v1/analyze",method:"POST",data:{attachment_ids:[r],language:(null===(s=window.aiMediaSEO)||void 0===s||null===(s=s.languages)||void 0===s?void 0:s.current)||"en"}});case 3:if(d=t.v,f=null===(u=d.results)||void 0===u?void 0:u[0],console.log("[useBatchProcessing] handleAnalyze - API result:",f),!f){t.n=5;break}return f.costs&&f.costs.total_cost?(console.log("[useBatchProcessing] handleAnalyze - Adding cost:",f.costs.total_cost),a(f.costs.total_cost)):console.warn("[useBatchProcessing] handleAnalyze - No costs in result:",f),t.n=4,o(r,{provider:f.provider||null,model:f.model||null,score:null!==f.score&&void 0!==f.score?parseFloat(f.score):null});case 4:t.n=6;break;case 5:return console.warn("[useBatchProcessing] handleAnalyze - No result in response"),t.n=6,o(r);case 6:t.n=8;break;case 7:return t.p=7,p=t.v,alert("Error: "+p.message),t.n=8,o(r);case 8:return t.p=8,n(r),t.f(8);case 9:return t.a(2)}},t,null,[[2,7,8,9]])}));return function(e){return t.apply(this,arguments)}}(),w=function(){var t=Bt(Et().m(function t(e){var n,r,l,c,f,y,m;return Et().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!p){t.n=1;break}return t.a(2);case 1:return t.p=1,h(!0),g.current=!1,d(null),t.n=2,i()({path:"/ai-media/v1/batch-analyze",method:"POST",data:{mode:e,attachment_ids:"selected"===e?s:[],language:(null===(n=window.aiMediaSEO)||void 0===n||null===(n=n.languages)||void 0===n?void 0:n.current)||"en"}});case 2:if((r=t.v).success&&0!==r.attachment_ids.length){t.n=3;break}return h(!1),d({type:"warning",message:r.message||"No images found to process."}),t.a(2);case 3:l=r.attachment_ids,c=r.language,v({active:!0,current:0,total:l.length,success:[],failed:[],errors:{}}),f=Et().m(function t(e){var n,r,s,u;return Et().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!g.current){t.n=1;break}return t.a(2,1);case 1:return n=l[e],j(T()),r=setInterval(function(){j(T())},2e3),t.p=2,t.n=3,i()({path:"/ai-media/v1/process-single",method:"POST",data:{attachment_id:n,language:c,auto_apply:!0,force_reprocess:!0}});case 3:return s=t.v,clearInterval(r),s.success?(console.log("[useBatchProcessing] handleBatchAnalyze - Success for attachment",n,"result:",s),s.costs&&s.costs.total_cost?(console.log("[useBatchProcessing] handleBatchAnalyze - Adding cost:",s.costs.total_cost),a(s.costs.total_cost)):console.warn("[useBatchProcessing] handleBatchAnalyze - No costs for attachment",n),v(function(t){return Ft(Ft({},t),{},{current:e+1,success:[].concat(It(t.success),[n])})})):v(function(t){return Ft(Ft({},t),{},{current:e+1,failed:[].concat(It(t.failed),[n]),errors:Ft(Ft({},t.errors),{},zt({},n,s.errors||["Unknown error"]))})}),t.n=4,o(n);case 4:t.n=6;break;case 5:t.p=5,u=t.v,clearInterval(r),v(function(t){return Ft(Ft({},t),{},{current:e+1,failed:[].concat(It(t.failed),[n]),errors:Ft(Ft({},t.errors),{},zt({},n,[u.message||"Unknown error"]))})});case 6:return t.a(2)}},t,null,[[2,5]])}),y=0;case 4:if(!(y<l.length)){t.n=7;break}return t.d(Tt(f(y)),5);case 5:if(!t.v){t.n=6;break}return t.a(3,7);case 6:y++,t.n=4;break;case 7:v(function(t){var e=t.success.length,n=t.failed.length,r=g.current;return d(r?{type:"warning",message:"Batch processing cancelled. Processed ".concat(t.current," of ").concat(t.total," images (").concat(e," successful, ").concat(n," failed).")}:0===n?{type:"success",message:"Batch processing completed successfully! ".concat(e," images processed.")}:e>0?{type:"warning",message:"Batch processing completed with some errors. ".concat(e," successful, ").concat(n," failed.")}:{type:"error",message:"Batch processing failed. All ".concat(n," images failed to process.")}),t}),v({active:!1}),h(!1),u(),t.n=9;break;case 8:t.p=8,m=t.v,d({type:"error",message:m.message||"An error occurred during batch processing."}),v({active:!1});case 9:return t.p=9,h(!1),t.f(9);case 10:return t.a(2)}},t,null,[[1,8,9,10]])}));return function(e){return t.apply(this,arguments)}}();return{batchProcessing:p,batchProgress:m,cancelledRef:g,processingStatus:x,handleAnalyze:S,handleBatchAnalyze:w}}({addProcessingId:f.addProcessingId,removeProcessingId:f.removeProcessingId,refreshAttachment:t.refreshAttachment,addCost:h.addCost,processingIds:f.processingIds,setAllAttachments:t.setItems,selectedIds:d.selectedIds,clearSelection:d.clearSelection,setAdminNotice:S}),P=lt("alt",{refreshAttachment:t.refreshAttachment,isAttachmentProcessing:A}),E=lt("caption",{refreshAttachment:t.refreshAttachment,isAttachmentProcessing:A}),N=lt("title",{refreshAttachment:t.refreshAttachment,isAttachmentProcessing:A}),F=lt("status",{refreshAttachment:t.refreshAttachment,isAttachmentProcessing:A}),z=function(t){var e=t.refreshAttachment,n=t.isAttachmentProcessing,r=function(){var t=et(J().m(function t(r){var o,a,l,c,s;return J().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!n||!n(r)){t.n=1;break}return t.a(2);case 1:if(t.p=1,l={meta:{}},c=!1,null!==(o=r.meta)&&void 0!==o&&o._ai_media_draft_alt&&(l.alt_text=r.meta._ai_media_draft_alt,l.meta._ai_media_draft_alt="",c=!0),null!==(a=r.meta)&&void 0!==a&&a._ai_media_draft_title&&(l.title=r.meta._ai_media_draft_title,l.meta._ai_media_draft_title="",c=!0),!c){t.n=3;break}return l.meta._ai_media_status="approved",t.n=2,i()({path:"/wp/v2/media/".concat(r.id),method:"POST",data:l});case 2:if(!e){t.n=3;break}return t.n=3,e(r.id);case 3:t.n=5;break;case 4:t.p=4,s=t.v,alert("Error approving metadata: "+s.message);case 5:return t.a(2)}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}();return{handleApprove:r}}({refreshAttachment:t.refreshAttachment,isAttachmentProcessing:A}),M=z.handleApprove,B=function(t){var e=Xt((0,r.useState)(!1),2),n=e[0],o=e[1],a=Xt((0,r.useState)(""),2),l=a[0],c=a[1],s=Xt((0,r.useState)([]),2),d=s[0],f=s[1],p=Xt((0,r.useState)(null),2),h=p[0],y=p[1],m=Xt((0,r.useState)(!1),2),v=m[0],g=m[1],b=Xt((0,r.useState)(null),2),x=b[0],j=b[1],S=function(){o(!1),y(null),j(null)},w=function(){var t=Yt(Kt().m(function t(){var e,n,r,o,a,c,s;return Kt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(l.trim()){t.n=1;break}return t.a(2);case 1:return g(!0),t.p=2,t.n=3,Promise.all([i()({path:"/wp/v2/posts?search=".concat(encodeURIComponent(l),"&per_page=10"),method:"GET"}),i()({path:"/wp/v2/pages?search=".concat(encodeURIComponent(l),"&per_page=10"),method:"GET"})]);case 3:e=t.v,n=Xt(e,2),r=n[0],o=n[1],a=r.map(function(t){var e;return Vt(Vt({},t),{},{type:"post",title:u(null===(e=t.title)||void 0===e?void 0:e.rendered)||"Untitled"})}),c=o.map(function(t){var e;return Vt(Vt({},t),{},{type:"page",title:u(null===(e=t.title)||void 0===e?void 0:e.rendered)||"Untitled"})}),f([].concat(qt(a),qt(c))),t.n=5;break;case 4:t.p=4,s=t.v,alert("Error searching posts/pages: "+s.message);case 5:return t.p=5,g(!1),t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}));return function(){return t.apply(this,arguments)}}(),O=function(){var e=Yt(Kt().m(function e(){var n;return Kt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(h&&x){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,t(x,h.id);case 2:S(),e.n=4;break;case 3:e.p=3,n=e.v,alert("Error attaching image: "+n.message);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}();return{isOpen:n,search:l,setSearch:c,results:d,selected:h,setSelected:y,searching:v,attachmentId:x,handleOpen:function(t){j(t),o(!0),c(""),f([]),y(null)},handleClose:S,handleSearch:w,handleConfirm:O}}(t.attachToParent),L=function(){var t=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return te(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useState)(null),2),e=t[0],n=t[1];return{hoveredImage:e,handleThumbnailEnter:function(t,e){var r=t.currentTarget.getBoundingClientRect();n({id:e.id,imageUrl:e.source_url,x:r.right+10,y:r.top})},handleThumbnailLeave:function(){n(null)}}}();return t.loading?(console.log("[MediaLibrary] Showing loading state..."),(0,re.jsx)("div",{className:"ai-media-library",children:(0,re.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,re.jsx)(o.Spinner,{}),(0,re.jsx)("p",{children:"Loading media library..."})]})})):t.error?(console.error("[MediaLibrary] Showing error state:",t.error),(0,re.jsx)("div",{className:"ai-media-library",children:(0,re.jsx)("div",{className:"notice notice-error",children:(0,re.jsxs)("p",{children:["Error loading attachments: ",t.error]})})})):(console.log("[MediaLibrary] Rendering main UI with",t.items.length,"items,","total:",t.totalItems),(0,re.jsxs)("div",{className:"wrap ai-media-library",children:[(0,re.jsx)(oe,{notice:j,onDismiss:function(){return S(null)}}),(0,re.jsx)(de,{onAddImage:v.openUploadModal}),(0,re.jsx)(be,{searchInput:a.searchInput,onSearchChange:a.setSearchInput,onSearch:a.handleSearch,onSearchKeyDown:a.handleSearchKeyDown,statusFilter:a.statusFilter,onStatusFilterChange:function(e){console.log("[MediaLibrary] Status filter changed:",e),t.invalidateCache(),a.setStatusFilter(e),c.resetPage()},statusFilterOptions:_,attachmentFilter:a.attachmentFilter,onAttachmentFilterChange:function(e){console.log("[MediaLibrary] Attachment filter changed:",e),t.invalidateCache(),a.setAttachmentFilter(e),c.resetPage()},attachmentFilterOptions:k}),(0,re.jsx)(xe,{selectedIds:d.selectedIds,batchProcessing:C.batchProcessing,onBatchAnalyze:C.handleBatchAnalyze,onBulkDelete:d.handleBulkDelete,totalCost:h.totalCost,loadingCosts:h.loadingCosts,onShowCostModal:function(){console.log("[MediaLibrary] Opening cost modal, refreshing data..."),h.setShowCostModal(!0),h.loadTotalCost()},onLoadCostStats:function(){console.log("[MediaLibrary] Loading cost stats..."),h.loadCostStats(),h.loadTotalCost()}}),(0,re.jsx)(Fe,{paginatedAttachments:t.items,selectedIds:d.selectedIds,onSelectAll:function(){return d.selectAll(t.items)},onToggleSelection:d.toggleSelection,isColumnVisible:m.isColumnVisible,currentPage:c.currentPage,totalPages:t.totalPages,totalItems:t.totalItems,onPageChange:c.goToPage,editingTitle:N.editing,savingTitle:N.saving,editingAlt:P.editing,savingAlt:P.saving,editingCaption:E.editing,savingCaption:E.saving,editingStatus:F.editing,savingStatus:F.saving,queueStatus:f.queueStatus,processingIds:f.processingIds,onTitleClick:N.handleClick,onTitleChange:N.updateValue,onTitleKeyDown:N.handleKeyDown,onTitleSave:N.handleSave,onAltClick:P.handleClick,onAltChange:P.updateValue,onAltKeyDown:P.handleKeyDown,onAltSave:P.handleSave,onCaptionClick:E.handleClick,onCaptionChange:E.updateValue,onCaptionKeyDown:E.handleKeyDown,onCaptionSave:E.handleSave,onStatusClick:F.handleClick,onStatusChange:F.updateValue,onStatusSave:F.handleSave,onApprove:M,onAttachToPost:B.handleOpen,onDetach:t.handleDetach,onAnalyze:C.handleAnalyze,onThumbnailEnter:L.handleThumbnailEnter,onThumbnailLeave:L.handleThumbnailLeave}),(0,re.jsx)(ae,{hoveredImage:L.hoveredImage}),(0,re.jsx)(ie,{batchProgress:C.batchProgress,processingStatus:C.processingStatus,onCancel:function(){},onClose:function(){},cancelledRef:C.cancelledRef}),(0,re.jsx)(le,{isOpen:B.isOpen,onClose:B.handleClose,search:B.search,onSearchChange:B.setSearch,onSearch:B.handleSearch,searching:B.searching,results:B.results,selected:B.selected,onSelect:B.setSelected,onConfirm:B.handleConfirm}),(0,re.jsx)(ce,{isOpen:v.uploadModalOpen,onClose:v.closeUploadModal,files:v.uploadFiles,uploadProgress:v.uploadProgress,uploading:v.uploading,onFileSelect:v.handleFileSelect,onStartUpload:v.handleStartUpload,onRemoveFile:v.handleRemoveFile,fileInputRef:v.fileInputRef,onDragEnter:v.handleDragEnter,onDragLeave:v.handleDragLeave,onDragOver:v.handleDragOver,onDrop:v.handleDrop,isDragging:v.isDragging}),(0,re.jsx)(ue,{isOpen:h.showCostModal,onClose:function(){return h.setShowCostModal(!1)},costStats:h.costStats,costBreakdown:h.costBreakdown,liveTotalCost:h.totalCost})]}))};document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("ai-media-library-root");t&&(0,r.render)((0,re.jsx)(Me,{}),t)})})();
//# sourceMappingURL=media-library.js.map